<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AME: Unit tests for CMSIS-NN</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AME
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__c_m_s_i_s_5__c_m_s_i_s__n_n__tests__unit_test__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Unit tests for CMSIS-NN </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Unit test CMSIS-NN functions on any Mbed supported HW.</p>
<p>Mbed are used for building and flashing. The Unity test framework is used for running the actual unit tests.</p>
<h1><a class="anchor" id="autotoc_md85"></a>
Requirements</h1>
<p>Python3 is required. It has been tested with Python 3.6 and it has been tested on Ubuntu 16 and 18.</p>
<p>There is a requirement file that can be used to install the dependencies.</p>
<div class="fragment"><div class="line">``` pip3 install -r requirements.txt</div>
</div><!-- fragment --><div class="fragment"><div class="line">Note that the exact versions are not required, and there are not a lot of packages to install manually.</div>
<div class="line">The file contains a lot of packages but that is because those are installed when installing some of the other packages.</div>
<div class="line">To manually install packages, see below.</div>
<div class="line"> </div>
<div class="line">### Executing unit tests</div>
<div class="line"> </div>
<div class="line">For executing unit tests, the python3 package pyserial is required. Version 3.4 of pyserial has been tested ok.</div>
</div><!-- fragment --><p> <code>pip3 install pyserial</code></p>
<div class="fragment"><div class="line">Other required python packages are mbed-cli and and mbed-ls. It should not matter if those are installed under python2 or python3 as they are command-line tools. These packages have been tested for Python2, with the following versions: mbed-ls(1.7.9) and mbed-cli(1.10.1).</div>
<div class="line"> </div>
<div class="line">### Generating new test data</div>
<div class="line"> </div>
<div class="line">For generating new data, the python3 packages tensorflow, numpy and packaging are required. Tensorflow version 2 is required as a minimum.</div>
<div class="line"> </div>
<div class="line">## Getting started</div>
<div class="line">Connect any HW (e.g. NUCLEO_F746ZG) that is supported by mbed. Multiple boards are supported. If all requirements are satisfied you can just run:</div>
</div><!-- fragment --><p> <code>./unittest_targets.py</code></p>
<div class="fragment"><div class="line">Use the -h flag to get more info.</div>
<div class="line"> </div>
<div class="line">## Generating new test data</div>
<div class="line">Generating new test data is done with the following script. Use the -h flag to get more info.</div>
</div><!-- fragment --><p> <code>./generate_test_data.py -h</code></p>
<p>```</p>
<p>The script use a concept of test data sets, i.e. it need a test set data name as input. It will then generate files with that name as prefix. Multiple header files of different test sets can then be included in the actual unit test files. When adding a new test data set, new c files should be added or existing c files should be updated to use the new data set. See overview of the folders on how/where to add new c files.</p>
<p>As it is now, when adding a new test data set, you would first have to go and edit the script to configure the parameters as you want. Once you are happy with the new test data set, it should be added in the load_all_testdatasets() function.</p>
<h1><a class="anchor" id="autotoc_md86"></a>
Overview of the Folders</h1>
<ul>
<li><code>Output</code> - This will be created when building.</li>
<li><code>Profiles</code> - These are the Mbed settings that are used.</li>
<li><code>PregeneratedData</code> - These are tests sets of data that have been previously been generated and are used in the unit tests.</li>
<li><code>TestCases</code> - Here are the actual unit tests. For each function under test there is a folder under here.</li>
<li><code>TestCases/&lt;cmsis-nn function name&gt;</code> - For each function under test there is a folder with the same name with test_ prepended to the name and it contains a c-file with the actual unit tests. For example for <a class="el" href="group___n_n_conv.html#ga34bb5c05805ca7d5ea9681fcad8a711d" title="Basic s8 convolution function.">arm_convolve_s8()</a> the file is called test_arm_convolve_s8.c</li>
<li><code>TestCases/&lt;cmsis-nn function name&gt;/Unity</code> - This folder contains a Unity file that calls the actual unit tests. For example for <a class="el" href="group___n_n_conv.html#ga34bb5c05805ca7d5ea9681fcad8a711d" title="Basic s8 convolution function.">arm_convolve_s8()</a> the file is called unity_test_arm_convolve_s8.c.</li>
<li><code>TestCases/&lt;cmsis-nn function name&gt;/Unity/TestRunner</code> - This folder will contain the autogenerated Unity test runner.</li>
<li><code>TestCases/TestData</code> - This is auto generated test data that the unit tests are using. It is the same data as in the PregenrateData folder but in actual C header format. The advantage of having the same data in two places, is that the data can be easily regenerated (randomized) with the same config. All data can regenerated or only parts of it (e.g. only bias data). Of course even the config can be regenerated. This might be useful during debugging. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
