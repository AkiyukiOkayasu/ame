<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AME: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AME
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__c_m_s_i_s_5__c_m_s_i_s__d_s_p__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md16"></a>
How to use</h1>
<p>This document is explaining how to use cmake with CMSIS-DSP.</p>
<p>The example arm_variance_f32 in folder Examples/ARM/arm_variance_f32 has been modified to also support cmake and is used as an example in this document.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Generating the Makefiles</h2>
<p>To build example arm_variance_f32 with cmake, you need to create a build folder where the build will take place. Don't build in your source directory.</p>
<p>You can create a build folder in Examples/ARM/arm_variance_f32</p>
<p>Once you are in the build folder, you can use cmake to generate the Makefiles.</p>
<p>The cmake command is requiring several arguments. For instance, to build for m7 with AC6 compiler: </p><pre class="fragment">cmake -DCMAKE_PREFIX_PATH="path to compiler (folder containing the bin folder)" \
-DCMAKE_TOOLCHAIN_FILE="../../../../armac6.cmake" \
-DARM_CPU="cortex-m7" \
-DROOT="../../../../../.." \
-DPLATFORM="FVP" \
-G "Unix Makefiles" ..
</pre><p> DCMAKE_PREFIX_PATH is the path to the compiler toolchain. This folder should contain the bin folder where are the compiler executables.</p>
<p>ROOT is pointing to the root CMSIS folder (the one containing CMSIS and Device).</p>
<p>PLATFORM is used to select the boot code for the example. In example below, Fast Model (FVP) is selected and the boot code for fast model will be used.</p>
<p>CMAKE_TOOLCHAIN_FILE is selecting the toolchain (ac6, ac5 or gcc). The files are in CMSIS/DSP.</p>
<p>ARM_CPU is selecting the core. The syntax must be the one recognized by the compiler. (So for instance different between AC5 and AC6).</p>
<p>The final .. is the path to the directory containing the CMakeLists.txt of the variance example. Since the build folder is assumed to be created in arm_variance_examples then the path to CMakeLists.txt from the build folder is ..</p>
<p>To build for A5, you need to change DCMAKE_TOOLCHAIN_FILE and ARM_CPU: </p><pre class="fragment">-DCMAKE_TOOLCHAIN_FILE=../../../../armac5.cmake 
-DARM_CPU="cortex-a5"
</pre><p> To build for A5 with Neon acceleration, you need to add: </p><pre class="fragment">-DNEON=ON
</pre> <h2><a class="anchor" id="autotoc_md18"></a>
Building</h2>
<p>Once cmake has generated the makefiles, you can use a GNU Make to build. </p><pre class="fragment">make VERBOSE=1
</pre> <h2><a class="anchor" id="autotoc_md19"></a>
Running</h2>
<p>The generated executable can be run on a fast model. For instance, if you built for m7, you could just do: </p><pre class="fragment">FVP_MPS2_Cortex-M7.exe -a arm_variance_example
</pre><p> The final executable has no extension in the filename.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
Building only the CMSIS-DSP library</h1>
<p>If you want to build only the CMSIS-DSP library and don't link with any boot code then you'll need to write a specific cmake.</p>
<p>Create a folder BuildCMSISOnly.</p>
<p>Inside the folder, create a CMakeLists.txt with the following content:</p>
<div class="fragment"><div class="line">cmake_minimum_required (VERSION 3.14)</div>
<div class="line"> </div>
<div class="line"># Define the project</div>
<div class="line">project (testcmsisdsp VERSION 0.1)</div>
<div class="line"> </div>
<div class="line"># Define the path to CMSIS-DSP (ROOT is defined on command line when using cmake)</div>
<div class="line">set(DSP ${ROOT}/CMSIS/DSP)</div>
<div class="line"> </div>
<div class="line"># Add DSP folder to module path</div>
<div class="line">list(APPEND CMAKE_MODULE_PATH ${DSP})</div>
<div class="line"> </div>
<div class="line">########### </div>
<div class="line">#</div>
<div class="line"># CMSIS DSP</div>
<div class="line">#</div>
<div class="line"> </div>
<div class="line"># Load CMSIS-DSP definitions. Libraries will be built in bin_dsp</div>
<div class="line">add_subdirectory(${DSP}/Source bin_dsp)</div>
</div><!-- fragment --><p>Create a build folder inside the BuildCMSISOnly folder.</p>
<p>Inside the build folder, type following cmake command </p><pre class="fragment">cmake -DROOT="path to CMSIS Root" \
  -DCMAKE_PREFIX_PATH="path to compiler (folder containing the bin folder)" \
  -DCMAKE_TOOLCHAIN_FILE="../../CMSIS_ROOT/CMSIS/DSP/armac6.cmake" \
  -DARM_CPU="cortex-m7" \
  -G "Unix Makefiles" ..
</pre><p> Now you can make: </p><pre class="fragment">make VERBOSE=1
</pre><p> When the build has finished, you'll have a bin_dsp folder inside your build folder. Inside bin_dsp, you'll have a folder per CMSIS-DSP Folder : BasicMathFunctions ...</p>
<p>Inside each of those folders, you'll have a library : libCMSISDSPBasicMath.a ...</p>
<h1><a class="anchor" id="autotoc_md21"></a>
Compilation symbols for tables</h1>
<p>Some new compilations symbols have been introduced to avoid including all the tables if they are not needed.</p>
<p>If no new symbol is defined, everything will behave as usual. If ARM_DSP_CONFIG_TABLES is defined then the new symbols will be taken into account.</p>
<p>Then you can select all FFT tables or all interpolation tables by defining following compilation symbols:</p>
<ul>
<li>ARM_ALL_FFT_TABLES : All FFT tables are included</li>
<li>ARM_ALL_FAST_TABLES : All interpolation tables are included</li>
</ul>
<p>If more control is required, there are other symbols but it is not always easy to know which ones need to be enabled for a given use case.</p>
<p>If you use cmake, it is easy since high level options are defined and they will select the right compilation symbols. If you don't use cmake, you can just look at fft.cmake to see which compilation symbols are needed.</p>
<p>For instance, if you want to use the arm_rfft_fast_f32, in fft.cmake you'll see an option RFFT_FAST_F32_32.</p>
<p>We see that following symbols need to be enabled :</p>
<ul>
<li>ARM_TABLE_TWIDDLECOEF_F32_16</li>
<li>ARM_TABLE_BITREVIDX_FLT_16</li>
<li>ARM_TABLE_TWIDDLECOEF_RFFT_F32_32</li>
<li>ARM_TABLE_TWIDDLECOEF_F32_16</li>
</ul>
<p>In addition to that, ARM_DSP_CONFIG_TABLES must be enabled and finally ARM_FFT_ALLOW_TABLES must also be defined.</p>
<p>This last symbol is required because if no transform functions are included in the build, then by default all flags related to FFT tables are ignored.</p>
<h1><a class="anchor" id="autotoc_md22"></a>
Bit Reverse Tables CMSIS DSP</h1>
<p>It is a question coming often.</p>
<p>It is now detailed <a href="https://github.com/ARM-software/CMSIS_5/issues/858">in this github issue</a></p>
<p>Someone from the community has written a <a href="https://gist.github.com/rosek86/d0d709852fddf36193071d7f61987bae">Python script to help</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
